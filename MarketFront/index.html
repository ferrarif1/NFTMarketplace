
<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Lei Shi">
  <meta http-equiv="Cache-Control" content="o-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">
  <meta name="csrf-token" content="1483758872##fd2cac389b2b7c009a744bcaecaa41d71592cfe8">
		
    <title>NFT在线交易平台</title>

	<link rel="shortcut icon" href="favicon.ico">
	<link rel="stylesheet" href="static/font-awesome//4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="static/highlight.js/9.8.0/monokai-sublime.min.css">
    <link rel="stylesheet" href="app/css/libs/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="app/css/libs/katex/0.6.0/katex.min.css">
    <link rel="stylesheet" href="app/css/libs/videojs/5.11.7/video-js.min.css">
	<link rel="stylesheet" href="app/css/dest/styles.css?=2016121272249">

	<style>
		@font-face {
			font-family: "lantingxihei";
			src: url("fonts/FZLTCXHJW.TTF");
		}

        /* modal 模态框*/
        #invite-user .modal-body {
            overflow: hidden;
        }
		#invite-user .modal-body .form-label {
			margin-bottom: 16px;
			font-size:14px;
		}
		#invite-user .modal-body .form-invite {
			width: 80%;
			padding: 6px 12px;
			background-color: #eeeeee;
			border: 1px solid #cccccc;
			border-radius: 5px;
			float: left;
			margin-right: 10px;
		}
		#invite-user .modal-body .msg-modal-style {
			background-color: #7dd383;
			margin-top: 10px;
			padding: 6px 0;
			text-align: center;
			width: 100%;
		}
		#invite-user .modal-body .modal-flash {
			position: absolute;
			top: 53px;
			right: 74px;
			z-index: 999;
		}
		/* end modal */

        .en-footer {
            padding: 30px;
            text-align: center;
            font-size: 14px;
        }
    </style>
	
<style style="text/css">
.navbar-banner {
    margin-top: 50px;
    background: url("img/homepage-bg.png");
    background-size: cover;
    backgtound-repeat: no-repeat;
}
</style>

</head>
<body>

<nav class="navbar navbar-default navbar-fixed-top header">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#header-navbar-collapse" aria-expanded="false">
                <span class="sr-only">NFT交易平台</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="index.html">
                <img src="img/A_logo.png">
            </a>
        </div>
        <div class="collapse navbar-collapse" id="header-navbar-collapse">
            <ul class="nav navbar-nav">
                <li class="dropdown active">
                    <a href="javascript:void(0);" class="dropdown-toggle" data-toggle="dropdown">
                        交易品
                        <span class="caret"></span>
                    </a>
                    <ul class="dropdown-menu">
                        <li><a class="active" href="courses/index.html" >全部交易品</a></li>
                        <li><a class="" href="courses/index.html?status=preview" >已上链</a></li>
                        <li><a class="" href="courses/index.html?status=pre">未上链</a></li>
                    </ul>
                </li>
                <!-- <li class="">
                    <a href="paths/index.html">路径</a>
                </li>
                <li class="">
                    <a href="questions/index.html">讨论区</a>
                </li>
                <li class=" bootcamp new-nav logo-1111">
                    <a href="bootcamp/index.html">交易品</a>
                    
                </li>
                <li class=" new-nav logo-1111">
                    <a href="vip/index.html">会员</a>
                    
                </li> -->
                
            </ul>

            
            <div class="navbar-right btns">
                <a class="btn btn-default navbar-btn sign-in" data-sign="signin" href="#sign-modal" data-toggle="modal">登录</a>
                <a class="btn btn-default navbar-btn sign-up" data-sign="signup" href="#sign-modal" data-toggle="modal">注册</a>
            </div>
            

            <form class="navbar-form navbar-right" action="search" method="get" role="search">
                <div class="form-group">
                    <input type="text" class="form-control" name="search" autocomplete="off" placeholder="搜索 交易品">
                </div>
            </form>
        </div>
    </div>
</nav>
        
	
<div class="navbar-banner layout-no-margin-top">
    <div class="banner-container">
        <div class="container">
            <div class="row">
                <div class="col-md-7">
                    <a class="container-title">
                        <!-- <img src="img/container-title-2.png" /> -->
                        <font color="white" style="font-size: 50px;">NFT交易平台</font>
                    </a>
                    <div style="margin-top:24px;">
                        <a id="course-btn" class="course-btn btn btn-lg" href="courses/index.html">进入艺术品界面</a>
                    </div>
                </div>
                
                <div class="col-md-5">
                    
                    <form action="/quickregister" method="post">
                        <div class="form-group">
                            <input class="form-control" name="name" id="name" type="text" placeholder="昵称">
                            <div class="help-block text-left"></div>
                        </div>
                        <div class="form-group">
                            <input class="form-control" name="email" id="email" type="email" placeholder="邮箱">
                            <div class="help-block text-left"></div>
                        </div>
                        <div class="form-group">
                            <input class="form-control" name="password" id="password" type="password" placeholder="密码">
                            <div class="help-block text-left"></div>
                        </div>
                        <button class="btn register" type="submit">加入艺术品交易平台</button>
                        <p class="tip">点击"加入艺术品交易平台"，表示您已经同意我们的<a href="privacy/index.html" target="_blank"> 隐私条款</a></P>
                    </form>
                    
                </div>
                
            </div>
        </div>
    </div>   
</div>

<div class="introduce-container" id="fourFeatures">
    <div class="container">
        <div class="row">
            <div class="introduce-unit col-sm-6 col-md-3">
                <div><a class="introduce-img"><img src="img/introduceContainer1.gif" /></a></div>
                <div><span class="introduce-span">丰富的艺术品种类</span></div>
            </div>
            <div class="introduce-unit col-sm-6 col-md-3">
                <div><a class="introduce-img"><img src="img/introduceContainer2.gif" /></a></div>
                <div><span class="introduce-span">NFT</span></div>
            </div>
            <div class="introduce-unit col-sm-6 col-md-3">
                <div><a class="introduce-img"><img src="img/introduceContainer3.gif" /></a></div>
                <div><span class="introduce-span">优势1</span></div>
            </div>
            <div class="introduce-unit col-sm-6 col-md-3">
                <div><a class="introduce-img"><img src="img/introduceContainer4.gif" /></a></div>
                <div><span class="introduce-span">优势2</span></div>
            </div>
        </div>
    </div>
</div>

<div class="line-and-laboratory">
	<div class="container">
        <div class="clearfix text-center item-header">
            <span class="line"></span>
            <span class="text-center item-title">最多浏览艺术品展示</span>
            <span class="line"></span>
        </div>
		<div class="tab-content">
			<div class="tab-pane clearfix active" id="study-line">
			
				
                <div class="col-xs-12 col-sm-6 col-md-4">
					<a href="paths/show.html">
                        <div class="path-item">
                            <div class="col-xs-5 col-sm-4 path-img">
                                <img src="img/1471513730333.png">
                            </div>
                            <div class="col-xs-7 col-sm-8">
                                <div class="path-name">艺术品名称1</div>
                                <div class="path-course-num">
                                    </span>价格：16￥</span>
                                </span>拥有者：YYY</span>
                                    
                                </div>
                            </div>
                            <div class="desc-layer">
                                <div class="center">这是个详细信息</div>
                            </div>
                        </div>
					</a>
                </div>
				
			
				
                <div class="col-xs-12 col-sm-6 col-md-4">
					<a href="paths/show.html">
                        <div class="path-item">
                            <div class="col-xs-5 col-sm-4 path-img">
                                <img src="img/1471513769430.png">
                            </div>
                             <div class="col-xs-7 col-sm-8">
                                <div class="path-name">艺术品名称1</div>
                                <div class="path-course-num">
                                    </span>价格：16￥</span>
                                </span>拥有者：YYY</span>
                                    
                                </div>
                            </div>
                            <div class="desc-layer">
                                <div class="center">这是个详细信息</div>
                            </div>
                        </div>
					</a>
                </div>
				
			
				
                <div class="col-xs-12 col-sm-6 col-md-4">
					<a href="paths/show.html">
                        <div class="path-item">
                            <div class="col-xs-5 col-sm-4 path-img">
                                <img src="img/1471513793360.png">
                            </div>
                            <div class="col-xs-7 col-sm-8">
                                <div class="path-name">艺术品名称1</div>
                                <div class="path-course-num">
                                    </span>价格：16￥</span>
                                </span>拥有者：YYY</span>
                                    
                                </div>
                            </div>
                            <div class="desc-layer">
                                <div class="center">这是个详细信息</div>
                            </div>
                        </div>
					</a>
                </div>
				
			</div>
		</div>
	</div>
</div>

	

	<div class="modal fade" id="invite-user" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">邀请好友，双方都可获赠实验豆！</h4>
				</div>
				<div class="modal-body">
                    
                        <p><h4><a href="#sign-modal" data-toggle="modal" data-sign="signin">登录</a>后邀请好友注册，您和好友将分别获赠3个实验豆！</h4></p>
                    
					<div id="msg-modal"></div>
				</div>
			</div>
		</div>
	</div>

	<div class="modal fade" id="flash-message" tabindex="-1" role="dialog">
		<div class="modal-dialog" rolw="document">
		</div>
	</div>
	<div class="modal fade" id="modal-message" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                    <h4 class="modal-title">注意</h4>
				</div>
				<div class="modal-body">
				</div>
				<div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
                    <button type="button" class="btn btn-primary confirm" data-dismiss="modal">确定</button>
				</div>
			</div>
		</div>
	</div>
    

    
    

	
		
			
		
	

    <div class="modal fade" id="sign-modal" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-sm" role="document">
        <div class="modal-content">
            <button type="button" class="close-modal" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
            <div class="modal-body">
                <ul class="nav nav-tabs" role="tablist">
                    <li role="presentation" class="active">
                        <a href="#signin-form" aria-controls="signin-form" role="tab" data-toggle="tab">登录</a>
                    </li>
                    <li role="presentation">
                        <a href="#signup-form" aria-controls="signup-form" role="tab" data-toggle="tab">注册</a>
                    </li>
                </ul>
                <div class="tab-content">
                    <div role="tabpanel" class="tab-pane active" id="signin-form">
                        <form action="/login" method="post">
                            <div class="form-group">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-envelope" style="margin:0;"></i>
                                    </div>
                                    <input type="email" name="login" class="form-control" placeholder="请输入邮箱">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-lock" style="margin:0;"></i>
                                    </div>
                                    <input type="password" name="password" class="form-control" placeholder="请输入密码">
                                </div>
                            </div>
                            <div class="form-inline verify-code-item" style="display:none;">
                                <div class="form-group">
                                    <div class="input-group">
                                        <input type="text" name="captcha_v" class="form-control" placeholder="请输入验证码">
                                    </div>
                                </div>
                                <img class="verify-code" src="" source="https://www.shiyanlou.com/captcha.gif">
                            </div>
                            <div class="form-group remember-login">
                                <input name="remember" type="checkbox" value="y"> 下次自动登录
                                <a class="pull-right" href="reset_password/index.html">忘记密码？</a>
                            </div>
                            <div class="form-group">
                                <input class="btn btn-primary" name="submit" type="submit" value="进入实验楼">
                            </div>
                            <div class="form-group widget-signin">
                                <span>快速登录</span>
                                <a href="/auth/qq?next="><i class="fa fa-qq"></i></a>
                                <a href="/auth/weibo?next="><i class="fa fa-weibo"></i></a>
                                <a href="/auth/weixin?next="><i class="fa fa-weixin"></i></a>
                                <a href="/auth/github?next="><i class="fa fa-github"></i></a>
                                <a href="/auth/renren?next="><i class="fa fa-renren"></i></a>
                            </div>
                            <div class="form-group error-msg">
                                <div class="alert alert-danger" role="alert"></div>
                            </div>
                        </form>
                    </div>
                    <div role="tabpanel" class="tab-pane" id="signup-form">
                        <form action="/register" method="post">
                            <div class="form-group">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-envelope" style="margin:0;"></i>
                                    </div>
                                    <input type="email" name="email" class="form-control" placeholder="请输入邮箱">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="input-group">
                                    <div class="input-group-addon">
                                        <i class="fa fa-lock" style="margin:0;"></i>
                                    </div>
                                    <input type="password" name="password" class="form-control" placeholder="请输入密码">
                                </div>
                            </div>
                            <div class="form-inline">
                                <div class="form-group">
                                    <div class="input-group">
                                        <input type="text" name="captcha_v" class="form-control" placeholder="请输入验证码">
                                    </div>
                                </div>
                                <img class="verify-code" src="" source="https://www.shiyanlou.com/captcha.gif">
                            </div>
                            <div class="form-group">
                                <input class="btn btn-primary" name="submit" type="submit" value="注册">
                            </div>
                            <div class="form-group agree-privacy">
                                注册表示您已经同意我们的<a href="privacy/index.html" target="_blank">隐私条款</a>
                            </div>
                            <div class="form-group widget-signup">
                                <span>快速注册</span>
                                <a href="/auth/qq?next="><i class="fa fa-qq"></i></a>
                                <a href="/auth/weibo?next="><i class="fa fa-weibo"></i></a>
                                <a href="/auth/weixin?next="><i class="fa fa-weixin"></i></a>
                                <a href="/auth/github?next="><i class="fa fa-github"></i></a>
                                <a href="/auth/renren?next="><i class="fa fa-renren"></i></a>
                            </div>
                            <div class="form-group error-msg">
                                <div class="alert alert-danger" role="alert"></div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<div id="txStatus"></div>
<div id="ConnectAccount"></div>
<button class="CreateOneRingNFTBtn btn">CreateOneRingNFTBtn</button>
<button class="connectButton btn">connectButton</button>

    <div id="base-data" data-flash="false" data-is-login=false data-is-jwt=true
        data-socket-url="wss://comet.shiyanlou.com"
        data-msg-user=""
        data-msg-system=""
    ></div>

    <script src="app/dest/lib/lib.js?=2016121272249"></script>
    <script src="static/jquery/2.2.4/jquery.min.js"></script>
    <script src="static/ace/1.2.5/ace.js"></script>
    <script src="static/aliyun/aliyun-oss-sdk-4.3.0.min.js"></script>
    <script src="static/highlight.js/9.8.0/highlight.min.js"></script>
    <script src="static/jspdf/1.2.61/jspdf.min.js"></script>
    <script src="static/plupload/2.1.9/js/plupload.full.min.js"></script>
    <script src="static/zeroclipboard/2.2.0/ZeroClipboard.min.js"></script>
    <script src="static/videojs/video.min.js"></script>
    <script src="static/bootstrap-tour/0.11.0/js/bootstrap-tour.min.js"></script>
    <script src="static/bootstrap-table/1.11.0/bootstrap-table.min.js"></script>
    <script src="static/bootstrap-table/1.11.0/locale/bootstrap-table-zh-CN.min.js"></script>
    <script src="static/bootstrap-table/1.11.0/extensions/filter-control/bootstrap-table-filter-control.min.js"></script>

    <script src="static/ravenjs/3.7.0/raven.min.js"></script>

    <script src="https://unpkg.com/@metamask/detect-provider/dist/detect-provider.min.js"></script>
    <script language="javascript" type="text/javascript" src="../src/js/web3.min.js"></script>
    <script language="javascript" type="text/javascript" src="../src/js/OnRingNFTMarketplaceABI.js"></script>
    <script language="javascript" type="text/javascript" src="../src/js/OneRingNFTABI.js"></script>
    <script>
        Raven.config('https://bc3878b7ed0a4468a65390bd79e6e73f@sentry.shiyanlou.com/5', {
            release: '3.12.13'
        }).install();


    
    var OneRingNFT;
    var OneRingNFTMarketPlace;
    var OneRingNFTAddress = "0xaEb872f5A37Ce9bAf03082cE5eD03dfe97c9F301";
    var OneRingNFTMarketPlaceAddress = "0xC702E64Ead57C84022F8389ce673c0B9B58e42ab";

    var web3js = window.web3 ? new Web3(window.web3.currentProvider) : new Web3(new Web3.providers.HttpProvider("https://ropsten.infura.io/v3/de1e8657274a494aa59476341cafc010"));;

    function startApp() {
      console.log(" ******  start App   ******")
      //合约通过已经在goerli网络部署的地址和相应的ABI文件实例化为变量 之后通过这个变量调用相应合约函数 实现与链上数据的交互
      OneRingNFT = new web3js.eth.Contract(oneRingNftABI, OneRingNFTAddress);
      OneRingNFTMarketPlaceAddress = new web3js.eth.Contract(oneRingNftMarketplaceABI, OneRingNFTMarketPlaceAddress);

      //test
      ownerOf(1).then(function (result, error) {
        if (error) {
          console.log(error);
        }
        else {
          var strA = "0x0000000000000000000000000000000000000000";
          var strB = new String(result);
          if (strA == strB) {
            console.log("NFT not exist!")
          } else if (OneRingNFTMarketPlaceAddress == strB) {
            console.log("Current OwnerOfNFTId is OneRingNFTMarketPlaceAddress" + OneRingNFTMarketPlaceAddress);
          } else {
            console.log("Current OwnerOfNFTId is : " + JSON.stringify(result));
          }
        }
      });

      //获取metamask账户
      connect();
    }


    // 等待用户确定连接时，应该禁用申请访问账户的按钮，因为必须确认后才能进行下面操作
    async function connect() {
      ethereum
        .request({ method: 'eth_requestAccounts' })
        .then(
          $("#ConnectAccount").text(web3.eth.accounts[0])
        )
        .catch((err) => {
          if (err.code === 4001) {
            // 用户拒绝连接
            console.log('Please connect to MetaMask.');
          } else {
            console.error(err);
          }
        });
    }
    /*
    涉及交易的直接调用合约完成
    查询的很少一部分调用合约，另外一部分后台数据库完成
    以下全部列出
    */
    /***********************************************************     OneRingNFT     **************************************************************************/

    ///交易
    function mintOneRingNFT(tokenUrl) {
      $("#txStatus").text("Creating OneRingNFT on the blockchain. This may take a while...");
      //value = 1000000000000000 = 0.001 ETH
      return OneRingNFT.methods.safeMint(tokenUrl)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    ///查询      
    //NFT 没有上架调用这个 上架后调用OneRingNFTMarketPlace的originalOwnerOfNFTId
    //如果上架了，将返回合约地址
    function ownerOf(id) {
      return OneRingNFT.methods.ownerOf(id).call();
    }


    function tokenURI(id) {
      return OneRingNFT.methods.tokenURI(id).call();
    }


    /***********************************************************     OneRingNFTMarketPlace     **************************************************************************/
    ///交易
    function addNFTToSellList(_tokenId, _price, _typeNum) {
      return OneRingNFTMarketPlace.methods.addNFTToSellList(_tokenId, _price, _typeNum)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function changePriceForEnglandAuctionsType(_tokenId, _price) {
      return OneRingNFTMarketPlace.methods.changePriceForEnglandAuctionsType(_tokenId, _price)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function decreasePriceForNetherlandsAuctionsType(_tokenId, _price) {
      return OneRingNFTMarketPlace.methods.decreasePriceForNetherlandsAuctionsType(_tokenId, _price)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function changePriceForSimpleAuctionsType(_tokenId, _price) {
      return OneRingNFTMarketPlace.methods.changePriceForSimpleAuctionsType(_tokenId, _price)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function makeOffer(_tokenId, _price) {
      return OneRingNFTMarketPlace.methods.makeOffer(_tokenId, _price)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function makeOfferWithUserFundsAndEther(_tokenId, _price) {
      return OneRingNFTMarketPlace.methods.makeOfferWithUserFundsAndEther(_tokenId, _price)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function fillOfferByNFTOwner(_offerId, _tokenId) {
      return OneRingNFTMarketPlace.methods.fillOfferByNFTOwner(_offerId, _tokenId)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function rejectAllOffers(_tokenId) {
      return OneRingNFTMarketPlace.methods.rejectAllOffers(_tokenId)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function cancelOwnOffer(_offerId) {
      return OneRingNFTMarketPlace.methods.cancelOwnOffer(_offerId)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function simpleBuyNFT(_tokenId) {
      return OneRingNFTMarketPlace.methods.simpleBuyNFT(_tokenId)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function cancelAllOfferAndWithdrawFromSellList(_tokenId) {
      return OneRingNFTMarketPlace.methods.cancelAllOfferAndWithdrawFromSellList(_tokenId)
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    function claimFunds() {
      return OneRingNFTMarketPlace.methods.claimFunds()
        .send({ from: web3.eth.accounts[0] })
        .on("receipt", function (receipt) {
          $("#txStatus").text(receipt);
        })
        .on("error", function (error) {
          $("#txStatus").text(error);
        });
    }

    ///查询 
    /*
    request owner of nftid
    NFT的当前拥有者
    */
    function ownerOfNFTId(_tokenId) {
      return OneRingNFTMarketPlace.methods.ownerOfNFTId(_tokenId).call();
    }
    /*
    request original owner of nftid
    NFT上架后 将被合约地址持有 查询NFT的原拥有者
    */
    function originalOwnerOfNFTId(_tokenId) {
      return OneRingNFTMarketPlace.methods.originalOwnerOfNFTId(_tokenId).call();
    }
    /*
    request NFT balance of owner
    某地址持有oneRingNFT的数量
    */
    function NFTbalanceOf(_owner) {
      return OneRingNFTMarketPlace.methods.NFTbalanceOf(_owner).call();
    }
    /*
    request ETH balance of owner
    用户在合约的存款余额
    */
    function ETHbalanceOf(_owner) {
      return OneRingNFTMarketPlace.methods.ETHbalanceOf(_owner).call();
    }
    /*
      request tokenURI of nftid
      NFT的元数据地址 通常为IPFS地址
    */
    function tokenURIOfNFTId(_tokenId) {
      return OneRingNFTMarketPlace.methods.tokenURIOfNFTId(_tokenId).call();
    }
    /*
     request best price of nftid
     某NFT的当前最高Offer价格 返回OfferId
    */
    function bestOfferOfNFTId(_tokenId) {
      return OneRingNFTMarketPlace.methods.bestOfferOfNFTId(_tokenId).call();
    }
    
    /*
      request offer detail of offer id
      返回特定Offer的细节数据
    */
    function offerDataOfOfferId(_Offerid) {
      return OneRingNFTMarketPlace.methods.offerDataOfOfferId(_Offerid).call();
    }




    /***********************************************************     Until     **************************************************************************/
    function getRandomInt(max) {
      return Math.floor(Math.random() * max);
    }

    /***********************************************************      UI     **************************************************************************/

    const CreateOneRingNFTBtn = document.querySelector('.CreateOneRingNFTBtn');

    CreateOneRingNFTBtn.addEventListener('click', () => {
      mintOneRingNFT("ipfs://ipfsHash" + getRandomInt(10000000)).then(function (result, error) {
        if (error) {
          console.log(error)
        }
        else {
          console.log("Mint Success !: " + JSON.stringify(result));
        }
      });
    });
    
    // 如果获取用户失败，应该让用户重新点击按钮连接。
    const ConnectBtn = document.querySelector('.connectButton');
    ConnectBtn.addEventListener('click', () => connect());

    /*
***********************************************************     Metamask check      *****************************************************************************************
 
 */

    
    window.addEventListener('load', function () {
      const provider = detectEthereumProvider();
      if (provider) {
        // From now on, this should always be true:
        // provider === window.ethereum
        startApp(provider); // initialize your app
        //获取链Id
        const chainId = ethereum.request({ method: 'eth_chainId' });
        ethereum.on('chainChanged', handleChainChanged);
        ethereum.on('accountsChanged', handleAccountsChanged);
      } else {
        console.log('Please install MetaMask!');
      }
    })




    //metamask钱包更换链时刷新页面
    function handleChainChanged(_chainId) {
      // 建议刷新页面，因为连接的节点不同了。
      window.location.reload();
    }
    //metamask钱包更换钱包时更新显示连接的钱包地址
    function handleAccountsChanged(accounts) {
      if (accounts.length === 0) {
        // 未连接钱包或者钱包锁定了
        console.log('Please connect to MetaMask.');
      } else {
        $("#ConnectAccount").text(web3.eth.accounts[0]);
      }
    }










    </script>

    




<div id="jinja-data"
    data-post-url="/registercheck"
></div>

<script src="app/dest/frontend/index.js?=2016121272249"></script>

<div class="footer">
    <div class="container">
        <div class="row">
            <div class="col-md-4 clearfix footer-col">
                <img src="img/logo_03.png">
                <div class="footer-slogan">快速交易</div>
                <div class="col-xs-2">
                    <div class="social-item footer-weixin-item">
                        <i class="fa fa-weixin"></i>
                        <div class="footer-weixin">
                            <img src="img/footer-weixin.png">
                        </div>
                    </div>
                </div>
                <div class="col-xs-2">
                    <div class="social-item footer-qq-item">
                        <i class="fa fa-qq"></i>
                    </div>
                </div>
                <div class="col-xs-2">
                    <div class="social-item footer-weibo-item">
                        <a href="http://weibo.com/shiyanlou2013" target="_blank">
                            <i class="fa fa-weibo"></i>
                        </a>
                    </div>
                </div>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-2 footer-col">
                <div class="col-title">公司</div>
                <a href="http://121.36.76.129/" target="_blank">关于我们</a><br>
                <a href="http://121.36.76.129/" target="_blank">联系我们</a><br>
                <a href="http://121.36.76.129/" target="_blank">加入我们</a><br>
                <a href="http://121.36.76.129/" target="_blank">技术博客</a><br>
            </div>
            <div class="col-xs-6 col-sm-3 col-md-2 footer-col">
                <div class="col-title">合作</div>
                <a href="http://121.36.76.129/" target="_blank">友情链接</a>
            </div>
        </div>
    </div>
    <div class="text-center copyright">
        <span>Copyright @2013-2016 NFT交易平台在线教育</span>
        <span class="ver-line"> | </span>
        <a href="http://www.miibeian.gov.cn/" target="_blank">蜀ICP备13019762号</a>
        <script type="text/javascript">
            var cnzz_protocol = (("https:" == document.location.protocol) ? " https://" : " http://");
            document.write(unescape("%3Cspan id='cnzz_stat_icon_5902315'%3E%3C/span%3E%3Cscript src='" + cnzz_protocol + "v1.cnzz.com/stat.php%3Fid%3D5902315' type='text/javascript'%3E%3C/script%3E"));
        </script>
        <script>
            var _hmt = _hmt || [];
            (function() {
             var hm = document.createElement("script");
             hm.src = "//hm.baidu.com/hm.js?6eb47a3aeda6ea31fa53985fdfdc78e8";
             var s = document.getElementsByTagName("script")[0];
             s.parentNode.insertBefore(hm, s);
             })();
        </script>
        <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
         (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
         m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
         })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
        ga('create', 'UA-89338452-1', 'auto');
        ga('send', 'pageview');
        </script>
    </div>
</div>

            


            
        
	
</body>
</html>
